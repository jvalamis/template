## Name
change me

## Description

### Project Status

- [x] project setup - linters, documentation and unit tests
- [x] project setup - support local development with documentation and code coverage reports via `npm run docs` and `npm run coverage`

## Stack
- node 16x

## Getting started
 
Check that you have node installed 

```node -v```

Check that you have npm installed 

```npm -v```

Check that you have nvm installed 

```nvm -v```

Switch to the node runtime of the project

```nvm use``` 

- if you don't have this version installed it will instead prompt you to install and switch to it

- change the version in ```.nvmrc``` to keep this readme relevant

Install dependencies 

```npm i```

To start working on src/index.js 

```npm run dev```

## Documentation
Use the following command to generate and serve the documentation on your local machine, these files are never checked in and can only be viewed locally. I spent some time to make these docs look good. Use the docs.

```npm run docs```

The config file for jsdocs is ```.jsdocrc.json```

```
"source": {
    "include": ["src"] // create docs from these directories
},
"opts": {
    "destination": "docs", // generate html assets here
    "template": "node_modules/jsdoc-baseline", // use this template
    "readme": "README.md" // include README.md
}
```

## Testing
Use the following command to run unit tests and generate a code coverage report

```npm run test```

Use the following command to view code coverage generated by the last unit tests via an html reporter, these files are never checked in and can only be viewed locally.

```npm run coverage```

#### [Mocha](https://github.com/mochajs/mocha)
The config file for mocha is ```.mocharc.yml```

```
spec: 'test/**/*.spec.js' // specify test directory/pattern
require: ["chai/register-expect"] // globally require expect and any other chai libraries
recursive: true
```

#### [c8](https://github.com/bcoe/c8) 
The config file for test coverage is ```.c8rc.json```

```
  "all": true, // check coverage for all files regardless of being explicitly imported in a .spec file
  "include": ["src"], // check coverage of files in this directory
  "reporter": ["html","text"], // html reporter for localhost report, text reporter for console
  "lines": 100, // require 100% coverage
  "branches": 100, // require 100% coverage
  "statements": 100, // require 100% coverage
  "per-file": 100, // require 100% coverage
  "check-coverage": true, // check coverage
  "clean": true // delete temp files before script execution
```

# Linting
Use the following command to run eslint, any errors here will cause the pipeline to fail

```npm run lint```


If you find yourself having an issue with this specific deprecation warning when runnning your unit tests...

```
(node:28806) [DEP0148] DeprecationWarning: Use of deprecated folder mapping "./" in the "exports" field module resolution of the package at /node_modules/chai/package.json 
imported from node_modules/mocha/lib/nodejs/esm-utils.js. Update this package.json to use a subpath pattern like "./*".
```

Navigate to ```node_modules/chai/package.json``` and change ```"./": "./"``` to ```"./*": "./*.js"```

#### [ESLint](https://github.com/eslint/eslint)
The config files for eslint are ```eslintrc.yml``` 

```
env:
  node: true // predefined globals for node
  mocha: true // predefined globals for mocha
extends: 
  - eslint:recommended
  - plugin:sonarjs/recommended 
  - plugin:unicorn/recommended
  - plugin:mocha/recommended
  - google
plugins:
  - sonarjs
  - unicorn
  - no-loops
  - mocha
parserOptions:
  sourceType: module
rules: 
  no-loops/no-loops: 2 // no for, for-in, while, do-while, for-of
  require-jsdoc : 0 // remove rules for jsdoc
  unicorn/no-array-reduce: off // allow reduce
  unicorn/prefer-object-from-entries: off // disable formatting to Object.entries()
overrides: 
  - files: '*.spec.js' // in test files...
    rules: 
        no-undef: 'off' // allow undefined variables, specifically for chai since we're defining it globally
```

- [eslint-plugin-sonarjs](https://github.com/SonarSource/eslint-plugin-sonarjs)
- [eslint-plugin-unicorn](https://github.com/sindresorhus/eslint-plugin-unicorn)
- [eslint-plugin-mocha](https://github.com/lo1tuma/eslint-plugin-mocha)
- [eslint-plugin-no-loops](https://github.com/buildo/eslint-plugin-no-loops)


and ```.eslintignore```

```
coverage // ignore output of npm run test
docs // ignore output of npm run docs
node_modules // ignore node_modules
.csv // ignore mock csv files in root
.env // no .env files, but just in case
.vscode // ignore vscode files
.zip // ignore zip files
.DS_store // ignore .DS_store mac specific
```

# Git
Ignored files for git are in  ```.gitignore``` 

```
coverage // ignore output of npm run test
docs // ignore output of npm run docs
node_modules // ignore node_modules
.csv // ignore mock csv files in root
.env // no .env files, but just in case
.vscode // ignore vscode files
.zip // ignore zip files
.DS_store // ignore .DS_store mac specific
```

# Gitlab
The yml file for gitlab is ```.gitlab-ci.yml```

```
image: node:16-alpine

stages:
  - build
  - upload
  - deploy

.somejob:
  script:
    - echo ls

build:
  extends: .somejob
  stage: build
  script:
    - echo ls
    - echo success
  artifacts:
    paths:
    - src/index.js

upload:
  extends: .somejob
  stage: upload
  script:
    - echo ls
    - echo success

upload:
  extends: .somejob
  stage: deploy
  script:
    - echo ls
    - echo success
  when: manual
```

## Visuals TODO: add visual
Depending on what you are making, it can be a good idea to include screenshots or even a video (you'll frequently see GIFs rather than actual videos). Tools like ttygif can help, but check out Asciinema for a more sophisticated method.

## Authors
jvalamis@gmail.com
